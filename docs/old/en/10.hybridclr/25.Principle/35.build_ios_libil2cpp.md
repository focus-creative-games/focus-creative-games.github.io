---
title: iOS packaging
date: 2022-05-29 20:55:59
permalink: /hybridclr/build_ios_libil2cpp/
categories:
  - HybridCLR
tags:
  - 
author: 
  name: Code Philosophy
  link: https:://code-philosophy.com
---

This document assumes that you have understood the packaging and building process under Windows or Mac, and understood the relevant precautions.

# iOS packaging


The xcode project generated when Unity packages the iOS target does not contain the libil2cpp source code like other platforms, but uses the pre-compiled libil2cpp.a. To compile an app that supports HybridCLR hot update, it needs to be replaced with the extended HybridCLR code libil2cpp.a. **Replace the libil2cpp.a file in the xcode project, please do it yourself**, the following only introduces how to compile libil2cpp.a.

The [com.focus-creative-games.hybridclr_unity](https://github.com/focus-creative-games/hybridclr_unity)/Data~/iOSBuild directory contains the scripts needed to compile `libil2cpp.a`. After installing the package and successfully initializing the HybridCLR plugin using the `HybridCLR/Installer...` command, the iOSBuild directory is copied to the `{project}/HybridCLRData/iOSBuild` directory. The compilation operations mentioned below are all completed under the `{project}/HybridCLRData/iOSBuild` directory.


## libil2cpp.a compile

- Make sure your macOS version >=12 and xcode version >=13. Which is the minimum supported version we haven't carefully verified.
- Make sure HybridCLR is installed and the plugin is successfully initialized using the menu `HybridCLR/Installer...`
- Check your project's HybriCLRSettings configuration (menu `HybridCLR/Settings`) to make sure the parameters are set correctly.
- Click menu `HybridCLRData/Generate/All` to generate all necessary files
- **OPTIONAL** Set `IPHONESIMULATOR_VERSION` variable. This variable indicates the version of iPhoneSimulator. If it is not set, the system default version of iPhoneSimulator will be used. Command like this `export IPHONESIMULATOR_VERSION=15.5`
- Open the command console and switch to the `{project}/HybridCLRData/iOSBuild` directory. Please make sure the absolute path of this path does not contain spaces! otherwise error
- bash ./build_libil2cpp.sh compiles libil2cpp.a. After running, if the libil2cpp.a file can be found in the `iOSBuild/build` directory and the size is greater than 60M, it means the compilation is successful


## Common errors

- Attempt to build without installing HybridCLR correctly
- Newer macOS (below 12) and the latest xcode are not installed
- Due to the git setting, the pulled build_libil2cpp.sh and build_lump.sh contain incorrect file end characters, which cause errors in the first few lines of code when the script runs. Error messages are also obvious, such as `/bin/bash^M file does not exist`. Run the command `cat -v build_libil2cpp.sh` to check that the line breaks are correct. Run `git config --global core.autocrlf input`, and then pull these two script files again. For details, please refer to [Git Line Break Settings](https://docs.github.com/cn/get-started/getting-started-with-git/configuring-git-to-handle-line-endings).
- The absolute path to `{project}/HybridCLRData/iOSBuild` contains spaces, causing the gen_lump.sh script to generate wrong results

