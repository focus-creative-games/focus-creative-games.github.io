(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{340:function(t,s,a){"use strict";a.r(s);var r=a(7),n=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"安装hybridclr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装hybridclr"}},[t._v("#")]),t._v(" 安装HybridCLR")]),t._v(" "),s("p",[t._v("这儿主要介绍安装过程，安装过程中涉及的参数及设置的详细文档请见"),s("RouterLink",{attrs:{to:"/hybridclr/hybridclr_unity/"}},[t._v("hybridclr_unity")])],1),t._v(" "),s("h2",{attrs:{id:"安装前预备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装前预备工作"}},[t._v("#")]),t._v(" 安装前预备工作")]),t._v(" "),s("ul",[s("li",[t._v("安装 2019.4.40、2020.3.26、2021.3.0或更高版本。新手强烈推荐先用2020.3.33版本熟悉热更新后，再尝试自己项目的版本。如果你安装的hybridclr_unity版本号<=1.1.6，由于Installer使用路径中的版本号来判定Unity版本，"),s("strong",[t._v("请确保安装路径中包含版本号")]),t._v("，例如 "),s("code",[t._v("d:\\Unity2020.3.33")]),t._v("，1.1.7及更高版本移除此限制。")]),t._v(" "),s("li",[t._v("由于使用il2cpp backend，要求安装Unity时必须包含il2cpp 组件。如果未安装，请自行在UnityHub中安装。")]),t._v(" "),s("li",[t._v("安装相关开发SDK及IDE\n"),s("ul",[s("li",[t._v("Win下需要安装"),s("code",[t._v("visual studio 2019")]),t._v("或更高版本。安装时必须选中 "),s("code",[t._v("使用c++的游戏开发")]),t._v(" 这个组件。如果你使用.net 7发布后的2022最新版本的vs，由于新版本vs与il2cpp有兼容性问题，发会生编译错误，请参照"),s("RouterLink",{attrs:{to:"/hybridclr/common_errors/"}},[t._v("常见错误")]),t._v("中 "),s("code",[t._v("Win 下 打包时遇到 xxxx\\il2cpp\\libil2cpp\\utils\\Il2CppHashMap.h(71): error C2039: 'hash_compare': is not a member of 'stdext'")]),t._v(" 问题的解决方式。")],1),t._v(" "),s("li",[t._v("Mac下需要安装xcode较新版本，例如"),s("code",[t._v("xcode 13.4.1 macos 12.4")]),t._v("。最小支持版本是哪个我们未仔细验证过。")])])]),t._v(" "),s("li",[t._v("安装git")])]),t._v(" "),s("h2",{attrs:{id:"安装hybridclr-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装hybridclr-package"}},[t._v("#")]),t._v(" 安装HybridCLR package")]),t._v(" "),s("p",[t._v("使用package manager的"),s("code",[t._v("install from git url")]),t._v("方式来安装hybridclr_unity package.")]),t._v(" "),s("p",[t._v("hybridclr_unity 的主仓库在 "),s("a",{attrs:{href:"https://github.com/focus-creative-games/hybridclr_unity",target:"_blank",rel:"noopener noreferrer"}},[t._v("github"),s("OutboundLink")],1),t._v(" ,国内快速的镜像仓库在"),s("a",{attrs:{href:"https://gitee.com/focus-creative-games/hybridclr_unity",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitee"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("目前hybridclr_unity package有多个分支，其中：")]),t._v(" "),s("ul",[s("li",[t._v("main分支为主分支。由于当前main分支也已经稳定，而且工作流更完善，新接入的项目强烈推荐直接安装main分支最新版本或 "),s("code",[t._v(">= 2.0.1")]),t._v(" 的版本。")]),t._v(" "),s("li",[t._v("1.0为稳定分支。1.0分支已经稳定运行很久，已经经受过大量上线项目验证，但工具流上略繁琐一点，一些新bug可能不会快速合并到此分支，已经上线或者马上要上线（如一个月内）的项目，可以选择该分支。")])]),t._v(" "),s("p",[t._v("目前main分支与1.0分支差别很小，都足以满足商业项目的稳定性要求，不用特别纠结选择哪个分支。")]),t._v(" "),s("p",[t._v("仓库地址：")]),t._v(" "),s("ul",[s("li",[t._v("main分支地址为 "),s("code",[t._v("https://gitee.com/focus-creative-games/hybridclr_unity.git")])]),t._v(" "),s("li",[t._v("1.0分支地址为 "),s("code",[t._v("https://gitee.com/focus-creative-games/hybridclr_unity.git#1.0")])]),t._v(" "),s("li",[t._v("其他tag版本地址为 "),s("code",[t._v("https://gitee.com/focus-creative-games/hybridclr_unity.git#{tag}")])])]),t._v(" "),s("p",[t._v("不熟悉从url安装package的请看"),s("a",{attrs:{href:"https://docs.unity3d.com/Manual/upm-ui-giturl.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("install from giturl"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("由于国内网络原因，在unity中可能遇到网络异常而无法安装。你可以先把 "),s("code",[t._v("com.focus-creative-games.hybridclr_unity")]),t._v(" clone或者下载到本地，然后再 "),s("a",{attrs:{href:"https://docs.unity3d.com/Manual/upm-ui-local.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("install from disk"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("或者更简单一点的做法，下载到本地后，将仓库文件夹目录改名为"),s("code",[t._v("com.focus-creative-games.hybridclr_unity")]),t._v("，直接复制到你们项目的"),s("code",[t._v("Packages")]),t._v("目录下即可。")]),t._v(" "),s("p",[t._v("hybridclr_unity在openupm上也有仓库，但由于有较大的更新延迟以及对分支支持不佳，openump上的仓库我们已经废弃，不再维护。")]),t._v(" "),s("h2",{attrs:{id:"初始化hybridclr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化hybridclr"}},[t._v("#")]),t._v(" 初始化HybridCLR")]),t._v(" "),s("p",[t._v("为了减少package自身大小，有一些文件需要从Unity Editor的安装目录复制。因此安装完插件后，还需要一个额外的初始化过程。")]),t._v(" "),s("p",[t._v("点击菜单 "),s("code",[t._v("HybridCLR/Installer...")]),t._v("，弹出安装界面。在点击安装之前，可能需要一些设置。由于随着版本变化，Installer一直在调整，请根据你当前版本读取下面对应的说明。")]),t._v(" "),s("h3",{attrs:{id:"如果你的版本-2-0-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如果你的版本-2-0-5"}},[t._v("#")]),t._v(" 如果你的版本 >= 2.0.5")]),t._v(" "),s("p",[t._v("hybridclr_unity中 "),s("code",[t._v("Data~/hybridclr_version.json")]),t._v(" 文件中已经配置了当前package版本对应的兼容 hybridclr及il2cpp_plus的分支或者tag，\nInstaller会安装配置中指定的版本，不再支持自定义待安装的版本。")]),t._v(" "),s("p",[t._v("示例配置如下。")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"versions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2019-2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2020-2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2021-2.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("如果你想安装其他版本的hybridclr或il2cpp_plus，修改该配置文件中的branch为目标分支或者tag。")]),t._v(" "),s("p",[t._v("绝大多数情况下，直接点击"),s("code",[t._v("安装")]),t._v("默认从远程仓库下载安装即可。如下图所示。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/hybridclr/install_default.jpg",alt:"install_default"}})]),t._v(" "),s("p",[t._v("从版本2.3.1起新增支持直接从本地自己制作的包含hybridclr的libil2cpp目录复制安装。如果你网络不好，或者没有安装git导致无法从仓库远程下载安装，则可以先将 "),s("a",{attrs:{href:"https://github.com/focus-creative-games/il2cpp_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("il2cpp_plus"),s("OutboundLink")],1),t._v("和"),s("a",{attrs:{href:"https://github.com/focus-creative-games/hybridclr",target:"_blank",rel:"noopener noreferrer"}},[t._v("hybridclr"),s("OutboundLink")],1),t._v("下载到本地后，再根据下面"),s("strong",[t._v("安装原理")]),t._v("小节的文档，由这两个仓库合并出含hybridclr的libil2cpp目录，接着在"),s("code",[t._v("Installer")]),t._v("安装界面中启用"),s("code",[t._v("从本地复制libil2cpp")]),t._v("选项，选择你制作的libil2cpp目录，再点击"),s("code",[t._v("安装")]),t._v("执行安装。如下图所示。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/hybridclr/install.jpg",alt:"install"}})]),t._v(" "),s("h3",{attrs:{id:"如果你的版本-1-1-20"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如果你的版本-1-1-20"}},[t._v("#")]),t._v(" 如果你的版本 >= 1.1.20")]),t._v(" "),s("p",[t._v("hybridclr_unity中 "),s("code",[t._v("Data~/hybridclr_version.json")]),t._v(" 文件中已经配置了当前package版本对应的兼容 hybridclr及il2cpp_plus的版本，\nInstaller会安装配置中指定的版本，不再支持自定义待安装的版本。")]),t._v(" "),s("p",[t._v("示例配置如下。")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"versions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"531f98365eebce5d1390175be2b41c41e217d918"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ebe5190b0404d1857832bd1d52ebec7c3730a01d"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"531f98365eebce5d1390175be2b41c41e217d918"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020-main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c6cf54285381d0b03a58126e0d39b6e4d11937b7"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"unity_version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hybridclr"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"531f98365eebce5d1390175be2b41c41e217d918"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"il2cpp_plus"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"branch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-main"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"99cd1cbbfc1f637460379e81c9a7776cd3e662ad"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("p",[t._v("如果你想安装其他版本的hybridclr或il2cpp_plus，修改该配置文件中的branch和hash即可。")]),t._v(" "),s("h3",{attrs:{id:"如果你的package版本-1-1-19"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如果你的package版本-1-1-19"}},[t._v("#")]),t._v(" 如果你的package版本 <= 1.1.19")]),t._v(" "),s("p",[t._v("填写你要安装的hybridclr和il2cpp_plus仓库的 commit id或branch或tag。如果hybridclr的版本号留空，则安装hybridclr仓库main分支的最新版本。\n如果il2cpp_plus的版本号留空，则安装相应年度版本主分支（如2020-main）的最新版本。")]),t._v(" "),s("p",[s("strong",[t._v("hybridclr_uniyt分支、hybridclr仓库的分支跟il2cpp_plus仓库分支必须匹配")]),t._v("。如果你hybridclr_unity使用了main分支，则hybridclr必须使用main分支，il2cpp_plus必须使用"),s("code",[t._v("{version}-main")]),t._v("，如果你hybridclr_unity使用了1.0分支， 则hybridclr必须使用"),s("code",[t._v("1.0")]),t._v("分支，il2cpp_plus必须使用"),s("code",[t._v("{version}-1.0")]),t._v("分支。 如果你使用了某个tag的版本，确保这个tag所属的分支匹配。")]),t._v(" "),s("p",[t._v("hybridclr仓库推荐填写"),s("code",[t._v("1.0")]),t._v("，即每次安装1.0分支的最新版本；il2cpp_plus仓库推荐填"),s("code",[t._v("{年度版本}-1.0")]),t._v("（如2020-1.0），即每次安装"),s("code",[t._v("{年度版本}-1.0")]),t._v("分支的最新版本。如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/hybridclr/install_version.jpg",alt:"image"}})]),t._v(" "),s("p",[t._v("目前已经发布了1.0.1稳定正式版本，同样推荐追求稳定的项目使用。hybridclr_unity取 "),s("code",[t._v("1.0.1-release")]),t._v("，hybridclr 版本取 "),s("code",[t._v("1.0.1-release")]),t._v("，il2cpp_plus版本取 "),s("code",[t._v("{version}-1.0.1-relase")]),t._v("。")]),t._v(" "),s("p",[t._v("========================================")]),t._v(" "),s("p",[t._v("完成以上设置后，点击"),s("code",[t._v("install")]),t._v("按钮完成安装。由于安装过程需要拉取hybridclr及il2cpp_plus仓库，有可能会因为网络故障而失败，如果\n发现失败时 "),s("code",[t._v("HybridCLRData/hybridclr_repo")]),t._v("或"),s("code",[t._v("HybridCLRData/il2cpp_plus_repo")]),t._v("为空，请再次尝试。")]),t._v(" "),s("p",[t._v("最常见失败原因为git未安装，或者安装git后未重启UnityEditor和UnityHub。如果你确信安装了git，cmd中也确实能运行git，则尝试重启电脑。")]),t._v(" "),s("p",[t._v("如果因为各种特殊原因未能完成自动化安装，请参照下面的"),s("strong",[t._v("安装原理")]),t._v("手动模拟整个安装过程。")]),t._v(" "),s("h2",{attrs:{id:"webgl平台的特殊处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webgl平台的特殊处理"}},[t._v("#")]),t._v(" WebGL平台的特殊处理")]),t._v(" "),s("p",[t._v("由于Unity自身原因，即使设置了WebGL平台无法本地安装，请看下面章节中关于全局安装的介绍以及查看"),s("RouterLink",{attrs:{to:"/hybridclr/supported_platform/"}},[t._v("跨平台支持")]),t._v(".")],1),t._v(" "),s("h2",{attrs:{id:"unity版本相关特殊操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unity版本相关特殊操作"}},[t._v("#")]),t._v(" Unity版本相关特殊操作")]),t._v(" "),s("h3",{attrs:{id:"unity-2021"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unity-2021"}},[t._v("#")]),t._v(" Unity 2021")]),t._v(" "),s("p",[t._v("注意！"),s("strong",[t._v("如果你的hybridclr_unity版本 >= 2.0.1")]),t._v("，由于已经使用MonoHook技术在不修改UnityEditor.CoreModule.dll的情况下也能复制出裁判后的AOT dll，"),s("strong",[t._v("不需要")]),t._v("执行以下操作。")]),t._v(" "),s("p",[t._v("补充元数据及"),s("code",[t._v("HybridCLR/Generate/*")]),t._v("下的部分命令依赖裁减后的AOT dll。但Unity 2021版本（2019、2020不需要）打包"),s("code",[t._v("iOS平台")]),t._v("(其他平台不需要)时，由于Unity Editor未提供公开接口可以复制出target为iOS时的裁剪后的AOT dll，故必须使用修改后的UnityEditor.CoreModule.dll覆盖Unity自带的相应文件。")]),t._v(" "),s("p",[t._v("具体操作为将 "),s("code",[t._v("{package目录}/Data~/ModifiedUnityAssemblies/2021.3.x/UnityEditor.CoreModule-{Win,Mac}.dll")]),t._v(" 覆盖 "),s("code",[t._v("{Editor安装目录}/Editor/Data/Managed/UnityEngine/UnityEditor.CoreModule.dll")]),t._v("，具体相关目录有可能因为操作系统或者Unity版本而有不同。")]),t._v(" "),s("p",[s("strong",[t._v("由于权限问题，该操作无法自动完成，需要你手动执行复制操作。")])]),t._v(" "),s("p",[s("code",[t._v("UnityEditor.CoreModule.dll")]),t._v(" 每个Unity小版本都不相同，我们目前暂时只提供了2021.3.1版本，如需其他版本请自己手动制作，详情请见 "),s("RouterLink",{attrs:{to:"/hybridclr/modify_unity_dll/"}},[t._v("修改Unity编辑器相关dll")]),t._v("。")],1),t._v(" "),s("h3",{attrs:{id:"unity-2019"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unity-2019"}},[t._v("#")]),t._v(" Unity 2019")]),t._v(" "),s("p",[t._v("为了支持2019，需要修改il2cpp生成的源码，因此我们修改了2019版本的il2cpp工具。故Installer的安装过程多了一个额外步骤：将 "),s("code",[t._v("{package}/Data~/ModifiedUnityAssemblies/2019.4.40/Unity.IL2CPP.dll")]),t._v(" 复制到 "),s("code",[t._v("{project}/HybridCLRData/LocalIl2CppData/il2cpp/build/deploy/net471/Unity.IL2CPP.dll")])]),t._v(" "),s("p",[s("strong",[t._v("注意，该操作在Installer安装时自动完成，不需要手动操作。")])]),t._v(" "),s("p",[t._v("由于时间有限，目前只制作了2019.4.40的"),s("code",[t._v("Unity.IL2CPP.dll")]),t._v("文件，将来会补充更多版本，如需其他版本请自己手动制作，详情请见 "),s("RouterLink",{attrs:{to:"/hybridclr/modify_unity_dll/"}},[t._v("修改Unity编辑器相关dll")]),t._v("，或者找我们的商业技术支持。")],1),t._v(" "),s("h2",{attrs:{id:"为不在支持版本列表中的unity版本安装hybridclr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为不在支持版本列表中的unity版本安装hybridclr"}},[t._v("#")]),t._v(" 为不在支持版本列表中的Unity版本安装HybridCLR")]),t._v(" "),s("p",[t._v("由于我们没有完全测试所有Unity版本，实际上一些不在支持列表中的Unity版本，也有可能能正常使用HybridCLR。安装方式如下：")]),t._v(" "),s("ul",[s("li",[t._v("找一个离你的版本最近的在支持列表中的版本，例如你的版本号为 2021.2.20,则离你最新的版本为2021.3.0。")]),t._v(" "),s("li",[t._v("先将你的Unity工程切换到这个最近的受支持的版本，安装HybridCLR。")]),t._v(" "),s("li",[t._v("切换回你的Unity版本。")]),t._v(" "),s("li",[t._v("尝试打包，如果能顺利运行，则表明HybridCLR支持你这个版本，如果有问题，那还是升级版本吧。")])]),t._v(" "),s("p",[t._v("由于大项目打包非常耗时，你可以直接使用 hybridclr_trial 项目来测试兼容性。")]),t._v(" "),s("h2",{attrs:{id:"安装原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装原理"}},[t._v("#")]),t._v(" 安装原理")]),t._v(" "),s("p",[t._v("本节只是介绍原理，安装libil2cpp的操作已由installer完成，并不需要你手动操作。")]),t._v(" "),s("p",[t._v("HybridCLR安装过程主要包含这几部分：")]),t._v(" "),s("ul",[s("li",[t._v("替换libil2cpp代码")]),t._v(" "),s("li",[t._v("对Unity Editor的少量改造")])]),t._v(" "),s("h3",{attrs:{id:"替换libil2cpp代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#替换libil2cpp代码"}},[t._v("#")]),t._v(" 替换libil2cpp代码")]),t._v(" "),s("p",[t._v("原始的libil2cpp代码是静态CLR，需要替换成改造后的libil2cpp才能支持热更新。改造后的libil2cpp由两部分构成")]),t._v(" "),s("ul",[s("li",[t._v("il2cpp_plus "),s("a",{attrs:{href:"https://github.com/focus-creative-games/il2cpp_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("github"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://gitee.com/focus-creative-games/il2cpp_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitee"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("hybridclr "),s("a",{attrs:{href:"https://github.com/focus-creative-games/hybridclr",target:"_blank",rel:"noopener noreferrer"}},[t._v("github"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://gitee.com/focus-creative-games/hybridclr",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitee"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("il2cpp_plus仓库为对原始libil2cpp作了少量修改以支持动态"),s("strong",[t._v("register")]),t._v("元数据的版本（改了几百行代码）。这个仓库与原始libil2cpp代码高度\n相似。2019-2021各有一个对应主开发分支"),s("code",[t._v("{version}-main")]),t._v("，另外还有对应的发布版本分支"),s("code",[t._v("{version}-x.x")]),t._v("。")]),t._v(" "),s("p",[t._v("hybridclr为解释器部分的核心代码，包含元数据加载、代码transform(编译)、代码解释执行。所有Unity版本共享同一套hybridclr代码。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/hybridclr/merge_hybridclr_dir.jpg",alt:"merge_hybridclr_dir"}})]),t._v(" "),s("p",[t._v("根据与你的Unity版本匹配的il2cpp_plus分支(详情见"),s("RouterLink",{attrs:{to:"/hybridclr/supported_unity_versions/"}},[t._v("supported_unity_versions")]),t._v(")和hybridclr制作出最终版本的libil2cpp后，有两种安装方式：")],1),t._v(" "),s("h4",{attrs:{id:"项目本地安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目本地安装"}},[t._v("#")]),t._v(" 项目本地安装")]),t._v(" "),s("p",[t._v("Unity允许使用环境变量"),s("code",[t._v("UNITY_IL2CPP_PATH")]),t._v("自定义"),s("code",[t._v("il2cpp")]),t._v("的位置。因此hybridclr_unity包中，将进程环境变量"),s("code",[t._v("UNITY_IL2CPP_PATH")]),t._v("指向"),s("code",[t._v("{project}/HyridCLRData/LocalIl2CppData-{platform}/il2cpp")]),t._v("。il2cpp目录从Unity Ediotr安装目录复制，然后替换"),s("code",[t._v("il2cpp/libil2cpp")]),t._v("目录为修改后lil2cpp。")]),t._v(" "),s("p",[t._v("为什么需要创建上层的"),s("code",[t._v("LocalIl2CppData-{platform}")]),t._v("目录，而不是只创建il2cpp呢？实测发现仅仅指定il2cpp目录位置是不够的，打包时Unity隐含假设了il2cpp同级有一个"),s("code",[t._v("MonoBleedingEdge")]),t._v("目录，所以创建了上级目录，将il2cpp及MonoBleedingEdge目录都复制过来。")]),t._v(" "),s("p",[t._v("因为不同平台Editor自带的il2cpp目录略有不同，LocalIl2CppData要区分platform。")]),t._v(" "),s("h4",{attrs:{id:"全局安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局安装"}},[t._v("#")]),t._v(" 全局安装")]),t._v(" "),s("p",[t._v("直接替换Editor安装目录的libil2cpp目录(Win下为{editor}/Data/il2cpp/libil2cpp，Mac类似)。优点是简单，缺点是会影响其他不使用hybridclr的项目，而且可能遇到目录权限问题。")]),t._v(" "),s("p",[s("code",[t._v("HybridCLRSettings.useGlobalIl2Cpp=true")]),t._v("时表示打包时使用Editor安装目录的libil2cpp，但仍然需要自己手动复制"),s("code",[t._v("{project}/HyridCLRData/LocalIl2CppData-{platform}/il2cpp/libil2cpp")]),t._v("目录替换editor下的对应目录。")]),t._v(" "),s("p",[t._v("由于权限原因，即使是全局安装，"),s("code",[t._v("Generate/xxx")]),t._v("命令修改的是本地"),s("code",[t._v("{project}/HyridCLRData/LocalIl2CppData-{platform}/il2cpp/libil2cpp")]),t._v("下的文件。"),s("strong",[t._v("请每次generate后都将本地libil2cpp目录覆盖全局安装目录")]),t._v("。")]),t._v(" "),s("p",[t._v("如果你下面的目录替换的安装方式，并且你的hybridclr_unity版本 >= 2.1.0，则"),s("strong",[t._v("第一次")]),t._v("覆盖libil2cpp前，请先运行"),s("code",[t._v("HybridCLR/Generate/Il2cppDef")]),t._v("（只此一次，后面不再需要，除非你切换了项目Unity版本）以生成正确的版本宏，再覆盖原始的libil2cpp目录。"),s("strong",[t._v("符号链接安装方式或者hybridclr_unity版本低于2.1.0不需要执行此操作")]),t._v("。")]),t._v(" "),s("p",[t._v("每次替换libil2cpp目录非常麻烦，强烈推荐当打包WebGL平台时，除了设置"),s("code",[t._v("HybridCLRSettings.useGlobalIl2Cpp=true")]),t._v("外，不要手动替换libil2cpp目录，而使用创建安装目录的libil2cpp目录到本地libil2cpp目录的软链接的方式。方法如下：")]),t._v(" "),s("ul",[s("li",[t._v("Win平台。以管理员权限打开命令行窗口，删除或者重命名原libil2cpp，然后运行 "),s("code",[t._v('mklink /D "<Editor安装目录的libil2cpp目录路径>" "{project}/HyridCLRData/LocalIl2CppData-{platform}/il2cpp/libil2cpp"')]),t._v("。")]),t._v(" "),s("li",[t._v("Linux或者Mac平台。以管理员权限打开命令行窗口，删除或者重命名原libil2cpp，然后运行 "),s("code",[t._v('ln -s "{project}/HyridCLRData/LocalIl2CppData-{platform}/il2cpp/libil2cpp" "<Editor安装目录的libil2cpp目录路径>"')]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"对unity-editor的少量改造"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对unity-editor的少量改造"}},[t._v("#")]),t._v(" 对Unity Editor的少量改造")]),t._v(" "),s("p",[t._v("原理在前面的"),s("code",[t._v("Unity版本相关特殊操作")]),t._v("小节已经介绍。")]),t._v(" "),s("h2",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),s("p",[t._v("由于 Unity 的缓存机制，更新 HybridCLR 后，一定要清除 Library\\Il2cppBuildCache 目录，不然打包时不会使用最新的代码。如果你使用Installer来自动安装或者更新HybridCLR，它会自动清除这些目录，不需要你额外操作。")])])}),[],!1,null,null,null);s.default=n.exports}}]);