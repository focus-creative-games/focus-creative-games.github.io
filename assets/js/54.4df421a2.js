(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{374:function(t,a,s){"use strict";s.r(a);var e=s(7),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("感谢"),a("a",{attrs:{href:"https://space.bilibili.com/1916310",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("宝鱼偷偷摸鱼")]),a("OutboundLink")],1),t._v(" 贡献的视频教程："),a("a",{attrs:{href:"https://www.bilibili.com/video/BV1xS4y1M7Aj",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("【01】新手上路")]),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV1m44y1j747",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("【02】定义配置结构")]),a("OutboundLink")],1),t._v(" "),a("br"),t._v("\n感谢"),a("a",{attrs:{href:"https://github.com/LiuOcean",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("L")]),a("OutboundLink")],1),t._v(" 开源的"),a("a",{attrs:{href:"https://github.com/LiuOcean/Luban_Unity_GUI",target:"_blank",rel:"noopener noreferrer"}},[t._v("Luban Unity工具"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),a("ol",[a("li",[t._v("安装"),a("a",{attrs:{href:"https://dotnet.microsoft.com/download/dotnet/6.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("dotnet sdk 6.0"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("下载"),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples",target:"_blank",rel:"noopener noreferrer"}},[t._v("luban_examples项目"),a("OutboundLink")],1),t._v("\n项目中包含测试配置、最新的"),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Luban Release"),a("OutboundLink")],1),t._v("以及大量的示例项目。为方便起见，后续提及到的文件，默认都指这个项目中的文件。")])]),t._v(" "),a("h2",{attrs:{id:"配置和代码生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置和代码生成"}},[t._v("#")]),t._v(" 配置和代码生成")]),t._v(" "),a("p",[t._v("配置生成使用示例 MiniTemplate，可以直接在文件夹中操作，或拷贝到一个新目录。若路径改变，请注意该示例中的脚本文件使用luban工具的路径为"),a("code",[t._v("..\\Tools\\Luban.ClientServer\\Luban.ClientServer.dll")]),t._v("，这里可能需要修改为你使用的路径。")]),t._v(" "),a("p",[t._v("目录及文件说明如下，执行 gen 脚本即可正常生成。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("luban_examples\\MiniTemplate\n│  .cache.meta                     # luban缓存文件\n│  gen.bat                         # bat 生成脚本\n│  gen.sh                          # sh 生成脚本\n│\n├─Datas                            # 数据源目录\n│      item.xlsx                   # excel 数据源文件\n│      __beans__.xlsx              # bean 定义文件，可以使用xml定义代替\n│      __enums__.xlsx              # enum 定义文件，可以使用xml定义代替\n│      __tables__.xlsx             # table 定义文件，可以使用xml定义代替\n│\n├─Gen                              # 生成的代码目录\n├─output_json                      # 生成的json文件目录\n└─Defines\n        __root__.xml               # luban 根文件\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("p",[t._v("此处示例生成了 json 配置文件和 对应的cs配置代码文件。使用时只要构造一个loader方法并传入Tables的构造函数即可。")]),t._v(" "),a("h3",{attrs:{id:"配表示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配表示例"}},[t._v("#")]),t._v(" 配表示例")]),t._v(" "),a("p",[t._v("下面以一个新表简单讲解文件配置格式。文件内容如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("##var")]),t._v(" "),a("th",[t._v("id")]),t._v(" "),a("th",[t._v("name")]),t._v(" "),a("th",[t._v("desc")]),t._v(" "),a("th",[t._v("count")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("##type")]),t._v(" "),a("td",[t._v("int")]),t._v(" "),a("td",[t._v("string")]),t._v(" "),a("td",[t._v("string")]),t._v(" "),a("td",[t._v("int")])]),t._v(" "),a("tr",[a("td",[t._v("##")]),t._v(" "),a("td",[t._v("id")]),t._v(" "),a("td",[t._v("名字")]),t._v(" "),a("td",[t._v("描述")]),t._v(" "),a("td",[t._v("个数")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("1001")]),t._v(" "),a("td",[t._v("item1")]),t._v(" "),a("td",[t._v("desc1")]),t._v(" "),a("td",[t._v("10")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("1002")]),t._v(" "),a("td",[t._v("item2")]),t._v(" "),a("td",[t._v("desc2")]),t._v(" "),a("td",[t._v("10")])])])]),t._v(" "),a("ul",[a("li",[t._v("第 1 行是 主字段行，包含表字段定义。单元格 A1 必须以##开头。表示这是一个有效数据表。")]),t._v(" "),a("li",[t._v("第 2 行是类型行，第1个单元格必须为 ##type。")]),t._v(" "),a("li",[t._v("第 3 行是注释行。 以##开头。 可以有0-N个注释行，而且可以出现在任何位置")]),t._v(" "),a("li",[t._v("第 4 行起是数据行。")])]),t._v(" "),a("p",[t._v("在 Datas 目录下的__tables__.xlsx添加表声明，至此reward表的创建工作大功告成！如下图：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("##var")]),t._v(" "),a("th",[t._v("full_name")]),t._v(" "),a("th",[t._v("value_type")]),t._v(" "),a("th",[t._v("define_from_file")]),t._v(" "),a("th",[t._v("input")]),t._v(" "),a("th",[t._v("...")])])]),t._v(" "),a("tbody",[a("tr",[a("td"),t._v(" "),a("td",[t._v("demo.TbReward")]),t._v(" "),a("td",[t._v("Reward")]),t._v(" "),a("td",[t._v("true")]),t._v(" "),a("td",[t._v("reward.xlsx")]),t._v(" "),a("td")])])]),t._v(" "),a("p",[a("strong",[t._v("像##var或者##type 这种带名字的行，可以随便调整行的位置。")]),t._v(" "),a("strong",[t._v("但注意")]),t._v(" 如果第一行是注释行，必须使用##comment，而不是##。否则会把第一行当字段名行而出错（这是出于兼容性，早期强制第一行是字段名行，允许只以##开头）。")]),t._v(" "),a("h2",{attrs:{id:"生成代码和数据以及在程序中使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成代码和数据以及在程序中使用"}},[t._v("#")]),t._v(" 生成代码和数据以及在程序中使用")]),t._v(" "),a("p",[t._v("有几个常见需求， 根据你的要求选择下面合适的文档")]),t._v(" "),a("ul",[a("li",[t._v("unity + c# + json")]),t._v(" "),a("li",[t._v("unity + puerts + json")]),t._v(" "),a("li",[t._v("UE4 + c++ + binary")]),t._v(" "),a("li",[t._v("UE4 + blueprint c++ + binary")]),t._v(" "),a("li",[t._v("UE4 + blueprint c++ + json")]),t._v(" "),a("li",[t._v("excel导出json，自己手写代码加载或者有其他使用目的")]),t._v(" "),a("li",[t._v("其他需求")])]),t._v(" "),a("h3",{attrs:{id:"unity-c-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unity-c-json"}},[t._v("#")]),t._v(" unity + c# + json")]),t._v(" "),a("p",[t._v("示例参考项目为 "),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects/Csharp_Unity_json",target:"_blank",rel:"noopener noreferrer"}},[t._v("Csharp_Unity_Json"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("项目准备。")]),t._v(" "),a("p",[t._v("拷贝示例项目中 Assets\\LubanLib 目录到你的Unity项目中（可以自由组织位置），"),a("strong",[t._v("===同时在Unity的PlayerSettings里开启unsafe选项===")]),t._v("（如果你们项目要求不开启unsafe，请群里求助）,此时尝试编译项目，理论上应该能成功编译。")])]),t._v(" "),a("li",[a("p",[t._v("运行生成命令（可以参考示例项目的gen_code_json.bat）")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("dotnet %Luban.ClientServer.dll%\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" cfg ^\n-- ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--define_file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__root__.xml 定义文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("配置数据根目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Datas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--output_code_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("生成的代码文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--output_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("导出的数据文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--service")]),t._v(" all ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--gen_types")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"code_cs_unity_json,data_json"')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("其中")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("%Luban.ClientServer.dll% 指向  luban_examples/Tools/Luban.ClientServer/Luban.ClientServer.dll")])]),t._v(" "),a("li",[a("p",[t._v("--define_file  参数为 MyConfigs/Defines/__root__.xml 的路径")])]),t._v(" "),a("li",[a("p",[t._v("--input_data_dir 参数为 MyConfigs/Datas 的路径")])]),t._v(" "),a("li",[a("p",[t._v("--output_code_dir 参数为生成的代码文件存放的路径。 建议建议指向 unity的 Assets 目录下的某级子目录")])]),t._v(" "),a("li",[a("p",[t._v("--output_data_dir 参数为生成的数据文件的存放路径。 建议指向Assets同级目录。")]),t._v(" "),a("p",[t._v("详细的命令文档请看 "),a("RouterLink",{attrs:{to:"/luban/command_tools/"}},[t._v("command_tools")]),t._v("。")],1),t._v(" "),a("p",[t._v("如果一切正常，会产生一系列日志，最终一行是 == succ == 。")]),t._v(" "),a("p",[t._v("类似这样")])])])])]),t._v(" "),a("div",{staticClass:"center-container"},[a("p",[a("img",{attrs:{src:"/img/luban/install/install_07.png",alt:"生成结果"}})])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("如果一切顺利。生成的代码文件会在 –output_code_dir 参数指定的 目录中，生成的配置数据会在 –output_data_dir 参数指定的目录中。确保 –output_code_dir 指向的目录在Assets目录下，**PlayerSetting里开启unsafe**，此时应该能编译成功。\n")])])]),a("ul",[a("li",[a("p",[t._v("加载配置")]),t._v(" "),a("p",[t._v("只需一行代码既可完成所有配置表的加载工具")]),t._v(" "),a("div",{staticClass:"language-csharp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")])]),t._v(" tables "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("cfg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Tables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" \n        JSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ReadAllText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gameConfDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("使用加载后的配置表")]),t._v(" "),a("p",[t._v("cfg.Tables 里包含所有配置表的一个实例字段。加载完 cfg.Tables 后，只需要用 tables.<表名> 就能获得那个表实例，接着可以做各种操作。例如我们要获取id = 10000 的那个道具。代码如下")]),t._v(" "),a("div",{staticClass:"language-csharp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("cfg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Item")]),t._v(" itemInfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TbItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nConsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("WriteLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id:{0} name:{1} desc:{2}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    itemInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" itemInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" itemInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Desc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("可能你会注意到，item.xml 里定义 Item 时，字段名 id,name,desc的首字母被大写了。这是因为工具会根据输出的语言，自动作相应代码风格的字段名转换，也即 boo_bar 会被转换为 BooBar 这样的名字。这也是为什么推荐 配置字段定义时统一使用 xx_yy_zz 的风格。")])]),t._v(" "),a("li",[a("p",[t._v("至此完成 配置加载与使用!")])])]),t._v(" "),a("h3",{attrs:{id:"unity-puerts-项目生成-ts代码-并生成json数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unity-puerts-项目生成-ts代码-并生成json数据"}},[t._v("#")]),t._v(" unity + puerts 项目生成 ts代码，并生成json数据")]),t._v(" "),a("p",[t._v("参考项目为 "),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects/TypeScript_Unity_Puerts_Json",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeScript_Unity_Puerts_Json"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("p",[t._v("创建并且运行生成命令（可以参考示例项目的gen_code_json.bat）")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("dotnet %Luban.ClientServer.dll%\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" cfg ^\n-- ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--define_file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__root__.xml 定义文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("配置数据根目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Datas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--output_code_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("生成的代码文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--output_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("导出的数据文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--service")]),t._v(" all ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--gen_types")]),t._v(" code_typescript_json,data_json ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--typescript:use_puerts_bytebuf")]),t._v(" ^\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--typescript:embed_bright_types")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("其中")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("%Luban.ClientServer.dll% 指向  luban_examples/Tools/Luban.ClientServer/Luban.ClientServer.dll")])]),t._v(" "),a("li",[a("p",[t._v("--define_file  参数为 MyConfigs/Defines/__root__.xml 的路径")])]),t._v(" "),a("li",[a("p",[t._v("--input_data_dir 参数为 MyConfigs/Datas 的路径")])]),t._v(" "),a("li",[a("p",[t._v("--output_code_dir 参数为生成的代码文件存放的路径。 建议建议指向 unity的 Assets 目录下的某级子目录")])]),t._v(" "),a("li",[a("p",[t._v("--output_data_dir 参数为生成的数据文件的存放路径。 建议指向Assets同级目录。")]),t._v(" "),a("p",[t._v("详细的命令文档请看 "),a("RouterLink",{attrs:{to:"/luban/command_tools/"}},[t._v("command_tools")]),t._v("。")],1),t._v(" "),a("p",[t._v("如果一切正常，会产生一系列日志，最终一行是 == succ == 。")])])])]),t._v(" "),a("li",[a("p",[t._v("加载配置")]),t._v(" "),a("p",[t._v("为cfg.Tables提供一个Loader,根据表名返回一个加载好的JSON对象。只需少量代码既可完成所有配置表的加载工具。")]),t._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" tables "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("cfg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Tables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" JsHelpers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ReadAllText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UnityEngine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GameData/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("使用加载后的配置表")]),t._v(" "),a("p",[t._v("cfg.Tables 里包含所有配置表的一个实例字段。加载完 cfg.Tables 后，只需要用 tables.<表名> 就能获得那个表实例，接着可以做各种操作。例如我们要获取id = 10000 的那个道具。代码如下")]),t._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TbGlobalConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bagCapacity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TbItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("至此完成 配置加载与使用!")])])]),t._v(" "),a("h3",{attrs:{id:"ue4项目-c-非蓝图-代码-binary数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ue4项目-c-非蓝图-代码-binary数据"}},[t._v("#")]),t._v(" UE4项目，c++（非蓝图）代码，binary数据")]),t._v(" "),a("p",[t._v("基准的参考项目为 "),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects/Cpp_Unreal_bin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cpp_Unreal_bin"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v('由于生成的代码依赖于一些头文件，你需要先从该项目 拷备Source\\Cpp_Unreal\\Private\\bright 到你们项目合适的位置。必须保证bright目录在include目录路径内，如生成的代码中 #include "bright/serialization/ByteBuf.h" 可以找到这个文件。')]),t._v(" "),a("p",[t._v('接着命令行参数取 --gen_types "code_cpp_bin,data_bin"')]),t._v(" "),a("h3",{attrs:{id:"excel导出json数据-自己手写代码加载使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#excel导出json数据-自己手写代码加载使用"}},[t._v("#")]),t._v(" excel导出json数据，自己手写代码加载使用")]),t._v(" "),a("p",[t._v("示例为 "),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects/Csharp_Unity_json",target:"_blank",rel:"noopener noreferrer"}},[t._v("GenerateDatas项目"),a("OutboundLink")],1),t._v(" 下的 gen_data_json2.bat\n（注意不是gen_data_json.bat,因为gen_data_json.bat中'--gen_types data_json',生成的json数据为记录列表，而不是以key-value形式组织，可能并不符合你的要求）。")]),t._v(" "),a("p",[t._v("脚本如下：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("dotnet %Luban.ClientServer.dll%\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" cfg ^\n -- ^\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--define_file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__root__.xml 定义文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("配置数据根目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Datas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--output_data_dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("导出的数据文件的路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ^\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--service")]),t._v(" all ^\n "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--gen_types")]),t._v(" data_json2\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("其中")]),t._v(" "),a("ul",[a("li",[t._v("%Luban.ClientServer.dll% 指向  luban_examples/Tools/Luban.ClientServer/Luban.ClientServer.dll")]),t._v(" "),a("li",[t._v("--define_file  参数为 MyConfigs/Defines/__root__.xml 的路径")]),t._v(" "),a("li",[t._v("--input_data_dir 参数为 MyConfigs/Datas 的路径")]),t._v(" "),a("li",[t._v("--output_data_dir 参数为生成的数据文件的存放路径。 建议指向Assets同级目录。")])]),t._v(" "),a("p",[t._v("此时运行脚本。应该能执行成功。生成的数据在 --output_data_dir 参数指定的目录下")]),t._v(" "),a("h2",{attrs:{id:"其他项目类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他项目类型"}},[t._v("#")]),t._v(" 其他项目类型")]),t._v(" "),a("p",[t._v("不同项目之间，仅仅是准备工作及 --gen_types 不一样， 请从"),a("a",{attrs:{href:"https://github.com/focus-creative-games/luban_examples/tree/main/Projects",target:"_blank",rel:"noopener noreferrer"}},[t._v("示例项目"),a("OutboundLink")],1),t._v("中找到与你项目匹配的项目，参考相应目录下的 gen_xxx.bat 即可。")]),t._v(" "),a("p",[t._v("生成的代码一般会依赖于一些工具类，请从相应项目里拷贝这些代码到自己项目即可。")]),t._v(" "),a("p",[t._v("更多可以参考 "),a("RouterLink",{attrs:{to:"/luban/generate_code_data/"}},[t._v("代码与数据生成")]),t._v(" 这个文档。")],1)])}),[],!1,null,null,null);a.default=n.exports}}]);